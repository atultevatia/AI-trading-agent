# Implement LangGraph Sector Scanning Agent

- [x] Design `sector_graph_code.py` with Map-Reduce Architecture <!-- id: 0 -->
    - [x] Define `OverallState` and `StockState` schemas
    - [x] Create `SectorLoader` node (Ticker Mapping)
    - [x] Create `StockAnalyst` node (TA + Sentiment + Risk)
    - [x] Create `Ranker` node (Filter + sort top 5)
- [x] Implement robust `yfinance` data fetching with error handling <!-- id: 1 -->
- [x] Update `app.py` to support Sector Input and Table Output <!-- id: 2 -->
- [x] Verify functionality with "AI" and "AUTO" sectors <!-- id: 3 -->
- [x] Implement Tiered Decision Logic (Strong/Watch/Monitor) in `sector_graph_code.py` <!-- id: 4 -->
- [x] Update `app.py` to display Tiers and Confidence <!-- id: 5 -->
- [x] Integrate Live NSE Sector Data (Replace hardcoded map) <!-- id: 6 -->
    - [x] Research python libraries for NSE indices (`nselib` or `yfinance` ^CNXAUTO etc)
    - [x] Update `SectorLoader` node to fetch dynamic constituents
    - [x] Update `app.py` sector selection dropdown
- [x] Integrate Real-Time News Sentiment <!-- id: 7 -->
    - [x] Install `feedparser`
    - [x] Create `news_engine.py` with caching and deduplication
    - [x] Update `sector_graph_code.py` to fetch real news
    - [x] Integrate sentiment scoring into LLM prompt
- [x] Pivot to Autonomous AI Trading Agent <!-- id: 8 -->
    - [x] Design Multi-Agent Architecture (Analyst, Risk Manager, Portfolio Manager)
    - [x] Implement `RiskManager` node for trade vetting
    - [x] Implement `PortfolioManager` node for dynamic allocation
    - [x] Enhance LLM prompts for agency and reasoning (remove hardcoded rules)
    - [x] Update Streamlit to show "Agent Reasoning Loops"
- [x] Performance Optimization <!-- id: 9 -->
    - [x] Implement Parallel LLM execution in `Analyst` node
    - [x] Implement Analysis Caching for stocks (TTL)
    - [x] Update `PortfolioManager` to handle larger batches efficiently
- [x] Advanced Speed Optimizations <!-- id: 10 -->
    - [x] Increase Concurrency to 15+ workers
    - [x] Merge Analyst and Risk Manager into a "Research Pipe" node to save sync overhead
    - [x] Add session-based constituent caching
- [x] Interactive Analysis Chatbot <!-- id: 11 -->
    - [x] Implement Chat Interface in `app.py`
    - [x] Seed Chat Agent with latest scan context (analyses)
    - [x] Add conversation history memory
    - [x] Fix chat styling and visual feedback
- [x] Paper Trading System <!-- id: 12 -->
    - [x] Create `paper_trade_engine.py` for storage (JSON/CSV)
    - [x] Add "Book Trade" functionality in reasoning logs
    - [x] Implement "Portfolio & Trade Journal" UI in `app.py`
    - [x] Add real-time P&L tracking for paper trades
    - [x] Implement trade closing/exit logic
    - [x] Implement Human-in-the-loop (HITL) confirmation step before booking
    - [x] Implement Chat-based trade booking with override capability
    - [x] Add Download button for trade data (persistent backup)
    - [x] Add Refresh button for live portfolio prices
- [x] Strategy Customization Engine <!-- id: 13 -->
    - [x] Create "Strategy Settings" tab in `app.py`
    - [x] Implement editable text areas for Analyst, Risk, and PM prompts
    - [x] Update `OverallState` in `sector_graph_code.py` to carry custom instructions
    - [x] Add "Reset to Default" logic for strategy prompts
    - [x] Implement strategy persistence (local storage/session)
- [x] Enhanced News Engine (Authentic Sources) <!-- id: 14 -->
    - [x] Update `news_engine.py` to use multi-source RSS (Moneycontrol, Reuters, NSE)
    - [x] Implement "Authenticity Weighting" (higher score for official announcements)
    - [x] Add support for fetching Corporate Announcements via NSE site filters
    - [x] Update Analyst prompt to prioritize high-authenticity news
- [x] Quantitative Scoring Engine <!-- id: 15 -->
    - [x] Update `sector_graph_code.py` Analyst prompt with weighted scoring logic
    - [x] Adjust `StockAnalysis` TypedDict to include `total_score` and `tier`
    - [x] Update `app.py` reasoning logs to display the Quantitative Tier and Score
    - [x] Verify alignment between Analyst conviction and calculated total_score
